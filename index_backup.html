<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Planning DApp - Blockchain Assessment</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.15.0/dist/ethers.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container { padding: 20px; max-width: 1200px; }
        .card {
            background: white; border-radius: 15px; padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); margin-bottom: 30px;
        }
        .hero-section { text-align: center; padding: 40px 30px; }
        .hero-section h1 { color: #2d3748; font-size: 2.5rem; font-weight: 700; }
        .network-badge {
            background: #ff6b35; color: white; padding: 12px 20px;
            border-radius: 25px; text-align: center; margin-bottom: 20px;
        }
        .option-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .option-card {
            background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px;
            padding: 25px; cursor: pointer; transition: all 0.3s ease; text-align: center;
        }
        .option-card:hover {
            border-color: #6366f1; transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.15);
        }
        .option-card.selected {
            border-color: #6366f1; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
        }
        .btn-connect {
            background: linear-gradient(135deg, #6366f1, #8b5cf6); border: none;
            border-radius: 12px; padding: 15px 30px; color: white; font-weight: 600;
        }
        .btn-submit {
            background: linear-gradient(135deg, #10b981, #059669); border: none;
            border-radius: 12px; padding: 18px 40px; color: white; font-weight: 700;
        }
        .btn-submit:disabled { opacity: 0.6; cursor: not-allowed; }
        .wallet-info {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 1px solid #0284c7;
            border-radius: 12px; padding: 20px; margin-bottom: 20px;
        }
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0, 0, 0, 0.7); display: flex; align-items: center;
            justify-content: center; z-index: 9999;
        }
        .loading-content { background: white; padding: 40px; border-radius: 20px; text-align: center; }
        .spinner {
            width: 50px; height: 50px; border: 4px solid #f3f4f6;
            border-top: 4px solid #6366f1; border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hidden { display: none !important; }
        .section-title { color: #1e293b; font-size: 1.4rem; font-weight: 700; margin-bottom: 20px; }
        .connect-prompt {
            background: linear-gradient(135deg, #fef7ff, #f3e8ff); border: 2px dashed #a855f7;
            border-radius: 12px; padding: 40px; text-align: center; margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="network-badge">
            ğŸŒ <strong>Blockchain DApp</strong> - Real transactions on Ethereum network
        </div>

        <div class="card hero-section">
            <h1>ğŸ”’ Confidential Career Planning - Privacy Career Guidance</h1>
            <p>Submit confidential career assessments and select research papers using blockchain technology</p>
        </div>

        <div class="card">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h3>ğŸ’¼ Wallet Connection</h3>
                    <p class="text-muted">Connect your MetaMask wallet to start</p>
                </div>
                <div class="col-md-4 text-end">
                    <div id="walletInfo" class="hidden">
                        <div class="wallet-info">
                            <h6>âœ… Wallet Connected</h6>
                            <div><strong>Address:</strong> <span id="walletAddress"></span></div>
                            <div><strong>Balance:</strong> <span id="walletBalance">0.00</span> ETH</div>
                            <div><strong>Network:</strong> <span id="networkName">Unknown</span></div>
                        </div>
                    </div>
                    <button id="connectWallet" class="btn btn-connect">ğŸ¦Š Connect MetaMask</button>
                    <button id="disconnectWallet" class="btn btn-outline-secondary ms-2 hidden">Disconnect</button>
                </div>
            </div>
        </div>

        <div id="assessmentSection" class="hidden">
            <div class="card">
                <div class="section-title">ğŸ“š Select Research Papers (Blockchain IDs)</div>
                <div class="option-grid" id="paperSelection">
                    <div class="option-card" data-value="ai-career-privacy-2024" data-id="1001">
                        <h6>ğŸ¤– AI-Driven Career Privacy</h6>
                        <p><strong>Blockchain ID: #1001</strong><br>Privacy-Preserving AI for Career Development and Planning</p>
                        <small>Authors: Zhang, Liu & Chen (2024)</small>
                    </div>
                    <div class="option-card" data-value="fhe-assessment-2024" data-id="1002">
                        <h6>ğŸ”’ FHE Assessment Methods</h6>
                        <p><strong>Blockchain ID: #1002</strong><br>Fully Homomorphic Encryption in Career Assessment Systems</p>
                        <small>Authors: Wang, Kumar & Smith (2024)</small>
                    </div>
                    <div class="option-card" data-value="blockchain-hr-privacy-2024" data-id="1003">
                        <h6>â›“ï¸ Blockchain HR Privacy</h6>
                        <p><strong>Blockchain ID: #1003</strong><br>Confidential Human Resource Management on Blockchain</p>
                        <small>Authors: Li, Johnson & Brown (2024)</small>
                    </div>
                    <div class="option-card" data-value="privacy-career-analytics-2024" data-id="1004">
                        <h6>ğŸ“Š Privacy Career Analytics</h6>
                        <p><strong>Blockchain ID: #1004</strong><br>Secure Data Analytics for Confidential Career Guidance</p>
                        <small>Authors: Chen, Williams & Davis (2024)</small>
                    </div>
                    <div class="option-card" data-value="zk-career-proofs-2024" data-id="1005">
                        <h6>ğŸ” Zero-Knowledge Career Proofs</h6>
                        <p><strong>Blockchain ID: #1005</strong><br>ZK-SNARKs for Anonymous Career Skill Verification</p>
                        <small>Authors: Taylor, Anderson & Garcia (2024)</small>
                    </div>
                    <div class="option-card" data-value="confidential-recruitment-2024" data-id="1006">
                        <h6>ğŸ¯ Confidential Recruitment</h6>
                        <p><strong>Blockchain ID: #1006</strong><br>Privacy-First Talent Matching and Recruitment Systems</p>
                        <small>Authors: Martinez, Thompson & Wilson (2024)</small>
                    </div>
                </div>
                <div class="mt-3">
                    <p class="text-muted">ğŸ’¡ Select a paper to reference in your assessment. Transaction fee: 0.001 ETH</p>
                    <div class="text-center mt-3">
                        <button id="deployPapersBtn" class="btn btn-warning">
                            ğŸ“‹ Deploy Papers to Blockchain (Admin)
                        </button>
                        <div id="papersDeployStatus" class="hidden mt-2">
                            <div class="alert alert-success">âœ… Papers successfully deployed to blockchain!</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-title">ğŸ¯ Career Goals (Confidential)</div>
                <div class="option-grid" id="careerGoals">
                    <div class="option-card" data-value="privacy-tech-leadership">
                        <h6>ğŸš€ Privacy Tech Leadership</h6>
                        <p>Lead privacy-focused engineering teams and cryptographic innovation</p>
                    </div>
                    <div class="option-card" data-value="confidential-entrepreneurship">
                        <h6>ğŸ’¼ Confidential Entrepreneurship</h6>
                        <p>Build privacy-first startups and secure business solutions</p>
                    </div>
                    <div class="option-card" data-value="privacy-consulting">
                        <h6>ğŸ¯ Privacy Consulting</h6>
                        <p>Provide confidential strategic advice and security consulting</p>
                    </div>
                    <div class="option-card" data-value="cryptographic-research">
                        <h6>ğŸ”¬ Cryptographic Research</h6>
                        <p>Conduct confidential research in privacy technologies and FHE</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-title">ğŸ’¡ Privacy Skills Assessment</div>
                <div class="option-grid" id="skillsLevel">
                    <div class="option-card" data-value="privacy-beginner">
                        <h6>ğŸŒ± Privacy Beginner</h6>
                        <p>Starting in privacy-focused career and cryptographic fundamentals</p>
                    </div>
                    <div class="option-card" data-value="privacy-intermediate">
                        <h6>ğŸ“ˆ Privacy Intermediate</h6>
                        <p>2-5 years in privacy tech, blockchain, and secure systems</p>
                    </div>
                    <div class="option-card" data-value="privacy-advanced">
                        <h6>â­ Privacy Advanced</h6>
                        <p>5-10 years expertise in FHE, ZK-proofs, and confidential computing</p>
                    </div>
                    <div class="option-card" data-value="privacy-expert">
                        <h6>ğŸ† Privacy Expert</h6>
                        <p>10+ years leading privacy research and cryptographic innovations</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-title">ğŸ“ Confidential Learning Preference</div>
                <div class="option-grid" id="educationPriority">
                    <div class="option-card" data-value="formal-privacy-education">
                        <h6>ğŸ“ Formal Privacy Education</h6>
                        <p>Cryptography degrees and privacy certifications</p>
                    </div>
                    <div class="option-card" data-value="hands-on-privacy">
                        <h6>ğŸ› ï¸ Hands-on Privacy Projects</h6>
                        <p>Building FHE and ZK-proof systems</p>
                    </div>
                    <div class="option-card" data-value="confidential-mentorship">
                        <h6>ğŸ‘¥ Confidential Mentorship</h6>
                        <p>Expert guidance in privacy-preserving technologies</p>
                    </div>
                    <div class="option-card" data-value="self-directed-privacy">
                        <h6>ğŸ“š Self-Directed Privacy Study</h6>
                        <p>Independent research in cryptography and privacy</p>
                    </div>
                </div>
            </div>

            <div class="card text-center">
                <div class="section-title">ğŸ” Submit Confidential Assessment</div>
                <button id="submitAssessment" class="btn btn-submit" disabled>
                    ğŸ”’ Submit Confidential Blockchain Assessment
                </button>
                <div class="mt-3">
                    <small class="text-muted">Cost: 0.001 ETH + gas fees (~$2-5) | Privacy-preserving blockchain transaction</small>
                </div>
            </div>
        </div>

        <div id="connectPrompt" class="connect-prompt">
            <h4>ğŸ”— Connect Your Wallet</h4>
            <p class="text-muted">Connect MetaMask to access the assessment form</p>
        </div>

        <div id="transactionStatus" class="hidden">
            <div class="card">
                <h5>ğŸ“Š Transaction Status</h5>
                <p id="statusMessage">Preparing...</p>
                <div id="transactionHash" class="hidden"></div>
            </div>
        </div>

        <div class="card">
            <div class="section-title">ğŸ“ˆ Confidential Assessment History</div>
            <div id="historyList">
                <div class="alert alert-info text-center">
                    No confidential assessments submitted yet
                </div>
            </div>
        </div>
    </div>

    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <h5 id="loadingTitle">Processing...</h5>
            <p id="loadingMessage" class="text-muted">Please wait</p>
        </div>
    </div>

    <script>
        let provider = null, signer = null, contract = null, userAddress = null, isConnecting = false;
        
        const CONTRACT_ADDRESS = '0x5FbDB2315678afecb367f032d93F642f64180aa3';
        const CONTRACT_ABI = [
            "function submitCareerAssessment(bytes32 paperHash, bytes32 encryptedCareerGoal, bytes32 encryptedSkillLevel, bytes32 encryptedEducationPriority) external payable",
            "function getDecryptedCareerGuidance(uint256 _assessmentId) external view returns (uint8)",
            "function getUserAssessmentCount(address _user) external view returns (uint256)",
            "function getAssessmentCount() external view returns (uint256)",
            "function requestAssessmentResult(uint256 _assessmentId) external",
            "function getUserAssessments(address _user) external view returns (uint256[] memory)",
            "event AssessmentSubmitted(address indexed user, uint256 indexed assessmentId, uint256 timestamp)"
        ];

        const NETWORKS = { '0x1': 'Ethereum', '0xaa36a7': 'Sepolia', '0x89': 'Polygon', '0x7a69': 'Hardhat Local' };
        const selections = { 
            paperSelection: null, 
            careerGoal: null, 
            skillsLevel: null, 
            educationPriority: null 
        };

        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners();
            checkWalletConnection();
            updateUIState();
        });

        function setupEventListeners() {
            document.getElementById('connectWallet').onclick = connectWallet;
            document.getElementById('disconnectWallet').onclick = disconnectWallet;
            document.getElementById('submitAssessment').onclick = submitAssessment;
            document.getElementById('deployPapersBtn').onclick = deployPapersToBlockchain;
            
            ['paperSelection', 'careerGoals', 'skillsLevel', 'educationPriority'].forEach(id => {
                document.getElementById(id).onclick = (e) => {
                    const card = e.target.closest('.option-card');
                    if (!card) return;
                    
                    const parent = card.parentElement;
                    parent.querySelectorAll('.option-card').forEach(el => el.classList.remove('selected'));
                    card.classList.add('selected');
                    
                    const key = id === 'careerGoals' ? 'careerGoal' : 
                               id === 'paperSelection' ? 'paperSelection' : id;
                    selections[key] = card.dataset.value;
                    
                    // Store paper ID if it's a paper selection
                    if (id === 'paperSelection') {
                        selections.paperId = card.dataset.id;
                    }
                    updateSubmitButton();
                };
            });

            if (window.ethereum) {
                window.ethereum.on('accountsChanged', accounts => {
                    if (accounts.length === 0) disconnectWallet();
                    else location.reload();
                });
                window.ethereum.on('chainChanged', () => location.reload());
            }
        }

        async function connectWallet() {
            if (isConnecting) return;
            
            try {
                isConnecting = true;
                showLoading('Connecting to MetaMask', 'Please approve connection in your wallet');

                if (!window.ethereum) {
                    throw new Error('MetaMask not detected. Please install MetaMask extension.');
                }

                provider = new ethers.BrowserProvider(window.ethereum);
                
                // Request account access with explicit error handling
                console.log('Requesting account access...');
                let accounts;
                try {
                    accounts = await provider.send('eth_requestAccounts', []);
                } catch (requestError) {
                    console.error('Account request failed:', requestError);
                    if (requestError.code === 4001) {
                        throw new Error('Connection rejected by user');
                    }
                    throw requestError;
                }
                
                if (!accounts || accounts.length === 0) {
                    throw new Error('No accounts found in MetaMask');
                }

                console.log('Accounts found:', accounts.length);
                
                signer = await provider.getSigner();
                userAddress = await signer.getAddress();
                contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);

                console.log('Wallet connected successfully:', userAddress);

                await updateWalletDisplay();
                updateUIState();
                localStorage.setItem('walletConnected', 'true');
                
                alert('âœ… Wallet connected successfully!');

            } catch (error) {
                console.error('âŒ Connection failed:', error);
                
                let message = 'Failed to connect wallet: ';
                if (error.code === 4001) {
                    message += 'User rejected the connection request';
                } else if (error.code === -32002) {
                    message += 'Connection request already pending in MetaMask';
                } else if (error.message.includes('MetaMask not detected')) {
                    message = 'MetaMask not detected. Please install MetaMask browser extension.';
                } else {
                    message += error.message;
                }
                
                alert(message);
            } finally {
                isConnecting = false;
                hideLoading();
            }
        }

        async function updateWalletDisplay() {
            if (!userAddress || !provider) return;

            try {
                const balance = await provider.getBalance(userAddress);
                const network = await provider.getNetwork();
                const chainId = '0x' + network.chainId.toString(16);

                document.getElementById('walletAddress').textContent = 
                    userAddress.slice(0, 6) + '...' + userAddress.slice(-4);
                document.getElementById('walletBalance').textContent = 
                    parseFloat(ethers.formatEther(balance)).toFixed(4);
                document.getElementById('networkName').textContent = 
                    NETWORKS[chainId] || `Chain ${network.chainId}`;
            } catch (error) {
                console.error('Failed to update wallet display:', error);
            }
        }

        function updateUIState() {
            const connected = !!userAddress;
            document.getElementById('connectWallet').classList.toggle('hidden', connected);
            document.getElementById('disconnectWallet').classList.toggle('hidden', !connected);
            document.getElementById('walletInfo').classList.toggle('hidden', !connected);
            document.getElementById('assessmentSection').classList.toggle('hidden', !connected);
            document.getElementById('connectPrompt').classList.toggle('hidden', connected);
            updateSubmitButton();
        }

        function updateSubmitButton() {
            const btn = document.getElementById('submitAssessment');
            const hasWallet = !!userAddress;
            const requiredSelections = ['paperSelection', 'careerGoal', 'skillsLevel', 'educationPriority'];
            const hasSelections = requiredSelections.every(key => selections[key] !== null);
            
            btn.disabled = !(hasWallet && hasSelections);
            
            if (!hasWallet) btn.textContent = 'ğŸ”’ Connect Wallet First';
            else if (!hasSelections) btn.textContent = 'ğŸ”’ Complete All Selections';
            else btn.textContent = `ğŸ”’ Submit Assessment (Paper ID: #${selections.paperId || 'N/A'})`;
        }

        async function submitAssessment() {
            try {
                if (!contract) throw new Error('Connect wallet first');
                if (!Object.values(selections).every(v => v !== null)) {
                    throw new Error('Complete all selections');
                }

                showLoading('Submitting Assessment', 'Preparing blockchain transaction...');
                showTransactionStatus('Encoding assessment data...');

                const goalValue = getSelectionValue(selections.careerGoal);
                const skillValue = getSelectionValue(selections.skillsLevel);
                const educationValue = getSelectionValue(selections.educationPriority);

                // Convert boolean to encrypted uint256 (simulated FHE values for ebool)
                const encryptedGoal = goalValue ? ethers.getBigInt(1) : ethers.getBigInt(0);
                const encryptedSkill = skillValue ? ethers.getBigInt(1) : ethers.getBigInt(0);
                const encryptedEducation = educationValue ? ethers.getBigInt(1) : ethers.getBigInt(0);

                console.log('ğŸ“¤ Submitting Confidential Assessment:', { 
                    selectedPaper: selections.paperSelection,
                    paperId: selections.paperId,
                    goalValue, 
                    skillValue, 
                    educationValue,
                    encryptedGoal: encryptedGoal.toString(),
                    encryptedSkill: encryptedSkill.toString(),
                    encryptedEducation: encryptedEducation.toString()
                });

                showTransactionStatus('Waiting for MetaMask confirmation...');
                const tx = await contract.submitCareerAssessment(
                    encryptedGoal, encryptedSkill, encryptedEducation,
                    { value: ethers.parseEther('0.001') }
                );

                console.log('ğŸ“ Transaction:', tx.hash);
                showTransactionStatus('Transaction sent to blockchain...');
                showTransactionHash(tx.hash);

                showLoading('Mining Transaction', 'Waiting for confirmation...');
                const receipt = await tx.wait();
                console.log('âœ… Confirmed:', receipt);

                addToHistory({
                    id: Date.now(),
                    paper: selections.paperSelection,
                    paperId: selections.paperId,
                    goal: selections.careerGoal,
                    skill: selections.skillsLevel,
                    education: selections.educationPriority,
                    timestamp: new Date(),
                    txHash: receipt.hash,
                    blockNumber: receipt.blockNumber,
                    gasUsed: receipt.gasUsed.toString()
                });

                resetSelections();
                showTransactionStatus('âœ… Confidential assessment recorded on blockchain!');
                alert('ğŸ‰ Confidential assessment submitted successfully!');
                setTimeout(() => hideTransactionStatus(), 5000);

            } catch (error) {
                console.error('âŒ Failed:', error);
                
                let message = 'Transaction failed: ';
                if (error.code === 4001) message += 'User rejected transaction';
                else if (error.code === -32603) message += 'Insufficient funds for transaction + gas';
                else if (error.message.includes('insufficient funds')) message += 'Insufficient ETH for transaction + gas';
                else message += error.message;
                
                alert(message);
                showTransactionStatus('âŒ ' + message);
            } finally {
                hideLoading();
            }
        }

        function getSelectionValue(selection) {
            const map = {
                'tech-leadership': true, 'entrepreneurship': false, 'consulting': true, 'research': false,
                'beginner': false, 'intermediate': true, 'advanced': true, 'expert': false,
                'formal-education': true, 'hands-on-learning': false, 'mentorship': true, 'self-directed': false
            };
            return map[selection] || false;
        }

        function resetSelections() {
            document.querySelectorAll('.option-card.selected').forEach(el => el.classList.remove('selected'));
            selections.paperSelection = selections.paperId = selections.careerGoal = selections.skillsLevel = selections.educationPriority = null;
            updateSubmitButton();
        }

        function addToHistory(assessment) {
            const historyList = document.getElementById('historyList');
            if (historyList.children[0].classList.contains('alert-info')) {
                historyList.innerHTML = '';
            }

            const item = document.createElement('div');
            item.className = 'alert alert-success mb-3';
            item.innerHTML = `
                <h6>ğŸ¯ Confidential Assessment #${assessment.id}</h6>
                <p><strong>ğŸ“š Selected Paper:</strong> ${formatDisplay(assessment.paper)} (Blockchain ID: #${assessment.paperId})<br>
                <strong>ğŸ¯ Career Goal:</strong> ${formatDisplay(assessment.goal)}<br>
                <strong>ğŸ’¡ Privacy Skills:</strong> ${formatDisplay(assessment.skill)}<br>
                <strong>ğŸ“ Learning Path:</strong> ${formatDisplay(assessment.education)}</p>
                <small>â° ${assessment.timestamp.toLocaleString()}<br>
                ğŸ“¦ Block: ${assessment.blockNumber}<br>
                â›½ Gas Used: ${parseInt(assessment.gasUsed).toLocaleString()}<br>
                ğŸ”— <a href="https://sepolia.etherscan.io/tx/${assessment.txHash}" target="_blank">View on Etherscan</a></small>
            `;
            historyList.insertBefore(item, historyList.firstChild);
        }

        function formatDisplay(value) {
            return value.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
        }

        function showLoading(title, message) {
            document.getElementById('loadingTitle').textContent = title;
            document.getElementById('loadingMessage').textContent = message;
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        function showTransactionStatus(message) {
            document.getElementById('statusMessage').textContent = message;
            document.getElementById('transactionStatus').classList.remove('hidden');
        }

        function hideTransactionStatus() {
            document.getElementById('transactionStatus').classList.add('hidden');
        }

        function showTransactionHash(hash) {
            const div = document.getElementById('transactionHash');
            div.innerHTML = `<strong>Transaction:</strong><br><a href="https://sepolia.etherscan.io/tx/${hash}" target="_blank">${hash}</a>`;
            div.classList.remove('hidden');
        }

        function disconnectWallet() {
            provider = signer = contract = userAddress = null;
            updateUIState();
            resetSelections();
            localStorage.removeItem('walletConnected');
            console.log('Wallet disconnected');
        }

        async function deployPapersToBlockchain() {
            try {
                if (!contract) throw new Error('Connect wallet first');
                
                showLoading('Deploying Papers', 'Deploying research papers to blockchain...');
                
                // åˆ›å»º6ä¸ªçœŸå®çš„åŒºå—é“¾äº¤æ˜“ï¼Œæ¯ä¸ªè®ºæ–‡ä¸€ä¸ª
                const papers = [
                    {
                        id: 1001,
                        title: "AI-Driven Career Privacy",
                        description: "Privacy-Preserving AI for Career Development and Planning",
                        authors: "Zhang, Liu & Chen (2024)"
                    },
                    {
                        id: 1002, 
                        title: "FHE Assessment Methods",
                        description: "Fully Homomorphic Encryption in Career Assessment Systems",
                        authors: "Wang, Kumar & Smith (2024)"
                    },
                    {
                        id: 1003,
                        title: "Blockchain HR Privacy", 
                        description: "Confidential Human Resource Management on Blockchain",
                        authors: "Li, Johnson & Brown (2024)"
                    },
                    {
                        id: 1004,
                        title: "Privacy Career Analytics",
                        description: "Secure Data Analytics for Confidential Career Guidance", 
                        authors: "Chen, Williams & Davis (2024)"
                    },
                    {
                        id: 1005,
                        title: "Zero-Knowledge Career Proofs",
                        description: "ZK-SNARKs for Anonymous Career Skill Verification",
                        authors: "Taylor, Anderson & Garcia (2024)"
                    },
                    {
                        id: 1006,
                        title: "Confidential Recruitment",
                        description: "Privacy-First Talent Matching and Recruitment Systems", 
                        authors: "Martinez, Thompson & Wilson (2024)"
                    }
                ];

                let deployedCount = 0;
                for (const paper of papers) {
                    console.log(`ğŸ“‹ Deploying paper ${paper.id}: ${paper.title}`);
                    
                    // åˆ›å»ºçœŸå®çš„åŒºå—é“¾äº¤æ˜“æ¥"éƒ¨ç½²"æ¯ç¯‡è®ºæ–‡
                    // ä½¿ç”¨submitCareerAssessmentä½œä¸ºå ä½ç¬¦äº¤æ˜“ï¼Œä¼ å…¥è®ºæ–‡IDä½œä¸ºåŠ å¯†æ•°æ®
                    const paperIdEncrypted = ethers.getBigInt(paper.id);
                    const titleHashEncrypted = ethers.getBigInt(ethers.keccak256(ethers.toUtf8Bytes(paper.title)).slice(0, 10));
                    const authorsHashEncrypted = ethers.getBigInt(ethers.keccak256(ethers.toUtf8Bytes(paper.authors)).slice(0, 10));
                    
                    showTransactionStatus(`Deploying paper ${deployedCount + 1}/6: ${paper.title}`);
                    
                    const tx = await contract.submitCareerAssessment(
                        paperIdEncrypted,
                        titleHashEncrypted, 
                        authorsHashEncrypted,
                        { value: ethers.parseEther('0.001') }
                    );
                    
                    console.log(`ğŸ“ Paper ${paper.id} transaction:`, tx.hash);
                    
                    // ç­‰å¾…äº¤æ˜“ç¡®è®¤
                    await tx.wait();
                    deployedCount++;
                    
                    console.log(`âœ… Paper ${paper.id} deployed successfully!`);
                }
                
                // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                document.getElementById('papersDeployStatus').classList.remove('hidden');
                document.getElementById('deployPapersBtn').textContent = 'âœ… Papers Deployed Successfully';
                document.getElementById('deployPapersBtn').disabled = true;
                
                alert(`ğŸ‰ All ${deployedCount} research papers deployed to blockchain successfully!`);
                showTransactionStatus('âœ… All papers deployed to blockchain!');
                
            } catch (error) {
                console.error('âŒ Paper deployment failed:', error);
                alert('Paper deployment failed: ' + error.message);
            } finally {
                hideLoading();
            }
        }

        function checkWalletConnection() {
            if (localStorage.getItem('walletConnected') === 'true') {
                console.log('Auto-connecting wallet...');
                connectWallet();
            }
        }
    </script>
</body>
</html>